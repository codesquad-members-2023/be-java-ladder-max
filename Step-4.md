# Step-4 : 리펙토링 2
- 2023.03.09(목)

---
# 계획/고민거리
## [1] 사다리 row를 객체로 분리하기 ✅ (0.5h)
- `ArrauList<ArrayList<Character>>`만 보면 각각의 List 가 무엇을 뜻하는지 알기 힘들다
- 사다리 row 객체를 만들어 `ArrayList<LadderRow>`로 변경하면 List가 사다리 row를 담고 있는것을 알아보기 쉽다

### char 대신 boolean 사용하기 ✅
- 사다리의 내용을 char 타입 대신 boolean으로 채워 필요없는 멤버 변수(`|`, `-`, ` `)를 제거할 수 있다 ❌
  - 아닌가? 결국 출력할 때 또 쓰이지 않나???
  - 대신 char 멤버 변수를 String 타입으로 바꾸어 출력 부분에서 `-` 대신 `-----`을 사용할 수 있을 듯
    - String 멤버 변수를 List에 따로 저장하지 않아도 된다는 이점이 있다.
- `boolean`은 1byte라서 메모리를 적게 차지한다

## [2] 결과 출력 시 이름이 사다리 가운데로 오도록 정렬 ✅ (1h)
- `%-5s` : 문자열 5자를 오른쪽 정렬하여 출력
- s가 5글자 미만일 때 s에 들어갈 문자열 뒤에 글자수에 걸맞는 공백을 붙여주는 방법
  - 4글자: `(5 - 4) / 2 = 0` -> `aaaa`  -> `_aaaa`
  - 3글자: `(5 - 3) / 2 = 1` -> `aaa_`  -> `_aaa_`
  - 2글자: `(5 - 2) / 2 = 1` -> `aa_`   -> `__aa_`
  - 1글자: `(5 - 1) / 2 = 2` -> `a__`   -> `__a__`
- `%5s`로 왼쪽 정렬하고 공백을 앞에 붙이기 -> 이걸로 하자!
  - 4글자: `(5 - 4) / 2 = 0` -> `aaaa`  -> `aaaa_`
  - 3글자: `(5 - 3) / 2 = 1` -> `_aaa`  -> `_aaa_`
  - 2글자: `(5 - 2) / 2 = 1` -> `_aa`   -> `_aa__`
  - 1글자: `(5 - 1) / 2 = 2` -> `__a`   -> `__a__`
- 개선(중간단계 문자열의 길이 구하기. 이전 단계에서 `+ 이름 길이`)
  - 4글자: `((5 - 4) / 2) + 4 = 4` -> `aaaa`  -> `aaaa_`
  - 3글자: `((5 - 3) / 2) + 3 = 4` -> `_aaa`  -> `_aaa_`
  - 2글자: `((5 - 2) / 2) + 2 = 3` -> `_aa`   -> `_aa__`
  - 1글자: `((5 - 1) / 2) + 1 = 3` -> `__a`   -> `__a__`
```text
참여할 사람 이름을 입력하세요. (이름은 쉼표(,)로 구분하세요)
a, ab, abc, abcd, abcde
최대 사다리 높이는 몇 개인가요?
4
  a     ab   abc   abcd abcde 
  |     |-----|     |-----|
  |     |     |-----|     |
  |-----|     |-----|     |
  |-----|     |-----|     |
```

## [3] 단위 테스트 1 - RadderRow 객체에서 선을 그릴 수 있는지 여부를 판단 ✅ (2h)
- 유닛 테스트를 작성할 때 입력값을 변경해도 항상 테스트에 영향을 주지 않게 하기 위해 assert 부분에 로직이 들어가는데 이렇게 해도 되는건가?
  - 로직이 들어가서 다른 사람들이 테스트 내용을 알아보기 힘들것 같다

## [4] 단위 테스트 2 - 결과 출력 시 이름 5글자를 출력하는가? ✅ (1h)
- 검증하려는 메서드가 private이라 private을 호출하는 public 메서드를 테스트하게 됐다
  - public 메소드에서 private 메서드의 결과를 활용/변경하다 보니 테스트하기가 번거로워 졌다.

## [5] 입력시 0글자도 유효성 검사하기 ✅

---
# 그룹 리뷰를 통해 얻은 개인 피드백
## [1] Players와 Player 분리해 보기 ✅ (0.5h)
- 플레이어 이름을 Players에서 문자열 배열로 다루는게 아니라 객체로 각각 다루면 테스트 할 때 더 유용할 것이라 생각됨
- Players 명칭은 PlayerGroup으로 바꾸기
  - 이름 변경에 따라 다른 클래스의 변수명도 수정. 
  - (만약 Players를 사용하는 class가 많았다면 바꾸지 못했을 것 같다. 처음부터 이름을 잘 지어야겠다)

### 피드백
- step-3에서 출력을 위한 toString() 부분을 Players 객체에 두었더니 Players 분리 과정에서 Players 내부가 변경되어도 다른 객체를 변경할 필요가 없어졌다.
- setter 같이 내부 상태를 외부로 가져가 쓰는게 왜 안좋은지 확실히 알게 되었다.

## [2] LadderRow에 세로줄(List에서 PlayerLine 부분) 없애기 && Bridge 객체를 생성하여 사다리 가로줄 다리(bridge)만 관리하기 ✅ (2h)
- 세로줄은 항상 플레이어 수만큼 있으므로 굳이 List에 값을 입력할 필요가 없어 보인다
  - 세로줄을 지우면 메서드 수, 로직도 줄어들 것 같다
- 그런데, 이걸 바꾸면 중간 로직, 결과도 다 바뀌기 때문에 테스트도 변경해줘야 한다.... 

### 객체를 분리하거나, 제거하면 이와 의존 관계인 객체/메서드들에 error가 뜨게 되는데 이 상태로 commit 해도 되는 건가?
- 일단 의존 관계인 객체/메서드들을 모두 수정한 뒤 commit 하였다

## [3] 필요 없는 멤버변수 제거 ✅
- 2차원 char 배열을 사용할 때 남아있던 멤버 변수들 필요 있는지, 재사용 가능성이 있는지 다시 학인해 보기
- [2] 과정에서 메서드의 지역변수로 이동하였다. 멤버변수가 한 메서드에서만 사용되어 이동하였으나 이게 좋은 걸까? 아직 판단이 안된다.

## [4] 단위 테스트 간소화 하기 ✅ (0.5h)
- 로직이 복잡해서 다른 사람이 이해하기 어렵고 변경하기 쉽지가 않을것 같다
- 테스트 준비(Arrange) 단계의 로직도 다시 생각해 봐야 할 것 같다
  - 입력값을 구성할 때 제약조건을 몰라도 쉽게 입력값을 바꿀 수 있도록 하고 싶다
- 어려워서 다른 사람들꺼 보고 할 수 있는 것만 작성했다
---
# 기타
## domain이 정확히 무엇인지?
- 해결하고자 하는 문제의 영역, 특정 비즈니스 분야나 문제 영역

##  비지니스 로직이 정확히 무엇인지?
- 클라이언트의 요청 사항을 구체적으로 처리하는 로직

## 단위 테스트 AAA 패턴
- 준비(Arrange), 실행(Act), 단언(Assert) 순으로 일관성 있게 단위 테스트를 작성하는 것
